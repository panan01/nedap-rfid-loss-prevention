<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Material+Icons+Outlined" rel="stylesheet">
  <link rel="stylesheet" href="css/icons.css">  <!-- Compiled from SCSS -->
  <link rel="stylesheet" href="font/fonts.css">
  <link rel="stylesheet" href="css/main.css">
  <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <title>Import/export</title>
</head>

<body>
<!-- Top navigation -->
<iframe src="navbar.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>

<div class="container-fluid">
  <div class="nav-entry" -icon="file_upload" -name="Data"></div>

  <div class="row">
    <!-- sidebar navigation -->
    <iframe src="sidebar.html" onload="this.before((this.contentDocument.body||this.contentDocument).children[0]);this.remove()"></iframe>

    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
      <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
        <div class="span1">
          <!--
          <form onsubmit="handleUpload()" method="POST" enctype="multipart/form-data" id="submitForm">
            <p>What file do you want to upload?</p>
            <input type="file" id="fileToUpload" name="fileToUpload" required>
            <br>
            <input type="submit" value="Submit">
            <p id="submitResponse"></p>
          </form>
          -->
          <div class="card-content">
            <form onsubmit="handleUpload()" method="POST" enctype="multipart/form-data" id="submitForm">
              <div class="fileinput">
                <span id="file-upload-description">Click or drop excel file to upload</span><br>
                <input accept="application/vnd.ms-excel,.xlsx" type="file" id="fileToUpload" name="fileToUpload" required>
              </div>
              <input type="submit" value="Submit">
              <p id="submitResponse"></p>
            </form>
          </div>
        </div>
        <div class="card-content">
          <a href="/loss_prevention_war/download/alarm" download="alarms">
            Download alarm data (as excel)
          </a>
          <br>
          <a href="/loss_prevention_war/download/article" download="articles">
            Download article data (as excel)
          </a>
          <br>
          <a href="/loss_prevention_war/download/store" download="stores">
            Download store data (as excel)
          </a>
        </div>
      </div>
    </main>
  </div>
</div>
</body>



<script>
  function handleUpload() {
    let items = document.getElementById("submitResponse");
    let xmlHttp = new XMLHttpRequest();
    xmlHttp.onreadystatechange = function() {
      if (this.readyState === 4 && this.status === 200) {
        items.textContent = this.responseText;
      }
    }
    let URI = "http://localhost:8080/loss_prevention_war/upload";
    let formData = new FormData();
    formData.append("fileToUpload", document.getElementById("fileToUpload").files[0]);
    xmlHttp.open("POST", URI, true);
    xmlHttp.send(formData);
    items.textContent = "Uploaded file, processing...";
  }

  function showFileName(event) {
    let input = event.srcElement;
    let fileName = input.files[0].name;
    let fileUploadDescription = document.getElementById('file-upload-description');
    fileUploadDescription.textContent = "Selected  " + fileName;
  }

  let form = document.getElementById("submitForm");
  function handleForm(event) { event.preventDefault(); }
  form.addEventListener('submit', handleForm);

  form.addEventListener('change', showFileName);
</script>


<style>
  .span1 {
    float: left;
  }
  .span2 {
    float: right;
  }
  .row-fluid {
    max-width: 550px;
  }
</style>

</html>

